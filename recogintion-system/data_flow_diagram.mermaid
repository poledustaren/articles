flowchart LR
    %% –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    subgraph Input ["üìÅ –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"]
        VoicesDir[voices/<br/>‚îî‚îÄ‚îÄ speaker_name/<br/>    ‚îú‚îÄ‚îÄ voice1.wav<br/>    ‚îî‚îÄ‚îÄ voice2.wav]
        AudioDir[audio_source/<br/>‚îú‚îÄ‚îÄ meeting1.wav<br/>‚îú‚îÄ‚îÄ interview.mp3<br/>‚îî‚îÄ‚îÄ call.flac]
    end

    %% –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤
    subgraph VoiceProcessing ["üé§ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤"]
        Combine[–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ<br/>–∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤]
        Extract[–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ<br/>—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤<br/>TitaNet]
        Store[(–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö<br/>–≥–æ–≤–æ—Ä—è—â–∏—Ö<br/>speaker_database.pkl)]
    end

    %% –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ
    subgraph AudioProcessing ["üéµ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ"]
        Convert[–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è<br/>–≤ WAV]
        Diarize[–î–∏–∞—Ä–∏–∑–∞—Ü–∏—è<br/>pyannote 3.1]
        Identify[–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è<br/>–ø–æ –ë–î]
        Transcribe[–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è<br/>gigaam ASR]
        EmotionAnalysis[–ê–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–π<br/>gigaam Emotion]
    end

    %% –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
    subgraph Matching ["üîó –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ"]
        TimeAlign[–í—Ä–µ–º–µ–Ω–Ω–æ–µ<br/>–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ]
        SpeakerMatch[–ü—Ä–∏–≤—è–∑–∫–∞<br/>–∫ –≥–æ–≤–æ—Ä—è—â–∏–º]
        EmotionMatch[–ü—Ä–∏–≤—è–∑–∫–∞<br/>—ç–º–æ—Ü–∏–π]
    end

    %% –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    subgraph Output ["üìÑ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã"]
        Transcription[transcriptions/<br/>‚îî‚îÄ‚îÄ file_transcription.txt<br/>    ‚îú‚îÄ‚îÄ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏<br/>    ‚îú‚îÄ‚îÄ –ì–æ–≤–æ—Ä—è—â–∏–µ<br/>    ‚îú‚îÄ‚îÄ –¢–µ–∫—Å—Ç<br/>    ‚îî‚îÄ‚îÄ –≠–º–æ—Ü–∏–∏]
        Unknown[voices_need_recognize/<br/>‚îî‚îÄ‚îÄ unknown_speaker_xxx/<br/>    ‚îú‚îÄ‚îÄ combined.wav<br/>    ‚îî‚îÄ‚îÄ segments_info.txt]
        Processed[processed/<br/>‚îú‚îÄ‚îÄ voices/<br/>‚îî‚îÄ‚îÄ audio_source/]
        Reports[–û—Ç—á–µ—Ç—ã<br/>‚îî‚îÄ‚îÄ speakers_report.txt]
    end

    %% –°–≤—è–∑–∏
    VoicesDir --> Combine
    Combine --> Extract
    Extract --> Store

    AudioDir --> Convert
    Convert --> Diarize
    Diarize --> Identify
    Store --> Identify
    Convert --> Transcribe
    Convert --> EmotionAnalysis

    Identify --> TimeAlign
    Transcribe --> SpeakerMatch
    EmotionAnalysis --> EmotionMatch
    TimeAlign --> SpeakerMatch
    SpeakerMatch --> EmotionMatch

    EmotionMatch --> Transcription
    Identify --> Unknown
    VoicesDir --> Processed
    AudioDir --> Processed
    Transcription --> Reports

    %% –°—Ç–∏–ª–∏
    classDef inputStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef processStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef outputStyle fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef dataStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px

    class VoicesDir,AudioDir inputStyle
    class Combine,Extract,Convert,Diarize,Identify,Transcribe,EmotionAnalysis,TimeAlign,SpeakerMatch,EmotionMatch processStyle
    class Transcription,Unknown,Processed,Reports outputStyle
    class Store dataStyle